---
keyword: [注册集群, 接入本地数据中心]
---

# 创建注册集群并接入本地数据中心集群

注册集群是用于将本地数据中心Kubernetes集群或其他云厂商Kubernetes集群接入阿里云容器服务管理平台统一管理的集群形态。本文将介绍如何创建一个注册集群并接入本地数据中心Kubernetes集群。

登录[RAM管理控制台](https://ram.console.aliyun.com/)和[弹性伸缩控制台](https://essnew.console.aliyun.com)开通相应的服务。

登录[RAM管理控制台](https://partners-intl.console.aliyun.com/#/ram)和[弹性伸缩控制台](https://partners-intl.console.aliyun.com/#/essnew)开通相应的服务。

1.  创建接入集群。

    1.  登录[容器服务管理控制台](https://cs.console.aliyun.com)[容器服务管理控制台](https://partners-intl.console.aliyun.com/#/cs)。

    2.  在控制台左侧导航栏中，单击**集群**。

    3.  在控制台左侧导航栏中，选择**集群** \> **集群**。

    4.  在集群列表页面中，单击页面右上角的**创建集群**。

    5.  在注册集群页签，完成创建集群配置项。

        |配置项|描述|
        |---|--|
        |**集群名称**|填写集群的名称。

**说明：** 集群名称应包含1~63个字符，可包含数字、汉字、英文字符或短划线（-）。 |
        |**资源组**|将鼠标悬浮于页面上方的**账号全部资源**，选择集群所在的资源组。这里显示选择的资源组。

![资源组](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0706659951/p127165.png) |
        |**地域**|选择集群所在的地域。 |
        |**专有网络**|您可以在已有VPC列表中选择所需的VPC和交换机。|
        |**虚拟交换机**|您可以在选定的VPC下选择所需的节点虚拟交换机。|
        |**网络插件**|选择**不开启**时，表示不使用节点池扩容云上计算资源则无需配置网络插件。|
        |选择**Terway**并选中**IPvlan**时，表示采用IPvlan+ebpf作为网卡共享模式虚拟化技术，只能使用Alibaba Cloud Linux2系统。|
        |**Pod虚拟交换机**|您可以在选定的VPC下选择所需的Pod虚拟交换机。|
        |**Service CIDR**|如无特殊需求，使用默认的172.21.0.0/20即可。|
        |**API Server访问**|ACK默认为API Server创建一个内网SLB实例，您可修改SLB实例规格。更多信息，请参见[实例规格](/cn.zh-CN/传统型负载均衡CLB/CLB用户指南/实例/实例概述.md)。

**说明：** 删除默认创建的SLB实例将会导致无法访问API Server。 |
        |**绑定EIP**|设置是否启用绑定EIP。选中此选项，会在集群中自动绑定EIP，用于建立集群链接。|
        |**安全组**|支持选择**自动创建普通安全组**、**自动创建企业级安全组**、**选择已有安全组**。有关安全组的详细内容，请参见[安全组概述](/cn.zh-CN/安全/安全组/安全组概述.md)。 |
        |**日志服务**|设置是否启用日志服务，您可使用已有Project或新建一个Project。勾选**使用日志服务**，会在集群中自动配置日志服务插件。创建应用时，您可通过简单配置，快速使用日志服务。更多详情，请参见[通过日志服务采集Kubernetes容器日志](/cn.zh-CN/Kubernetes集群用户指南/可观测性/日志管理/通过日志服务采集Kubernetes容器日志.md)。 |
        |**集群删除保护**|设置是否启用集群删除保护。为防止通过控制台或API误释放集群。|
        |**标签**|为集群绑定标签。输入键和对应的值，单击**添加**。

**说明：**

        -   键是必需的，而值是可选的，可以不填写。
        -   键不能是aliyun、acs:、http://或https://开头的字符串，不区分大小写，最多64个字符。
        -   值不能是aliyun、acs:、http://或https://开头的字符串，可以为空，不区分大小写，最多128个字符。
        -   同一个资源，标签键不能重复，相同标签键（Key）的标签会被覆盖。
        -   如果一个资源已经绑定了20个标签，已有标签和新建标签会失效，您需要解绑部分标签后才能再绑定新的标签。 |
        |**服务协议**|创建集群前，需阅读并同意*服务条款*及*免责申明*。|

    6.  在页面右侧，单击**创建集群**，完成集群创建。

        您可以在集群列表，看到您创建的集群。

        ![集群列表](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6206659951/p48728.png)

2.  将目标集群接入注册集群中。

    1.  在新集群（本例中为**test-external-cluster1**）右侧单击**操作**列下的**详情**。

    2.  在**集群信息**页面单击**连接信息**页签。

    3.  在**集群导入代理配置**区域根据需要选择**公网**或者**私网**，然后单击右侧的**复制**，将公网或私网页签的内容复制到一个文件中，并执行kubectl命令，将目标集群注册至新集群中。

        例如，您可以新建agent.yaml文件，将以下内容复制到agent.yaml文件中，并在目标集群中执行`kubectl apply -f agent.yaml`命令。

        ![导入配置](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/4926545161/p48732.png)

    4.  在目标集群中执行以下命令，查看代理运行状况。

        ```
        kubectl -n kube-system get pod |grep ack-cluster-agent
        ```

        预期输出：

        ```
        ack-cluster-agent-5f7d568f6-6fc4k              1/1     Running   0          9s
        ack-cluster-agent-5f7d568f6-tf6fp              1/1     Running   0          9s
        ```

        注册成功后，您可以在容器服务管理控制台的Kubernetes集群列表页面，看到该集群的状态为**运行中**。


在集群列表页面中，找到注册集群，单击**操作**列下的**详情**，查看新集群的**基本信息**和**连接信息**。

您可以使用该kubeconfig连接目标集群，进行应用负载的部署。连接集群的具体操作步骤，请参见[通过kubectl连接Kubernetes集群](/cn.zh-CN/Kubernetes集群用户指南/集群/连接集群/通过kubectl连接Kubernetes集群.md)。

**相关文档**  


[注册集群概述](/cn.zh-CN/Kubernetes集群用户指南/多云混合云/注册集群概述.md)

