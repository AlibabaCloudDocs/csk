# 通过控制台使用动态云盘卷

本文主要为您介绍如何通过控制台使用动态云盘卷。

[创建Kubernetes托管版集群](/cn.zh-CN/Kubernetes集群用户指南/集群/创建集群/创建Kubernetes托管版集群.md)

## 创建StorageClass

1.  登录[容器服务管理控制台](https://cs.console.aliyun.com)。

2.  在控制台左侧导航栏中，单击**集群**。

3.  在集群列表页面中，单击目标集群名称或者目标集群右侧**操作**列下的**详情**。

4.  在集群管理页左侧导航栏中，选择**存储** \> **存储类**。

5.  单击**存储类**页签，在**存储类**页面单击**创建**，在**创建**对话框中设置参数。

    -   **名称**：云盘的名称。
    -   **存储卷类型**：配置为云盘，标识StorageClass使用阿里云云盘provisioner插件创建。
    -   **存储驱动**：本例中设置为**Flexvolume**。
    -   **参数**：本例中，包含的示例参数为type和zoneid。
        -   type：标识云盘类型，支持cloud\_efficiency、cloud\_ssd、cloud\_essd、available四种参数，其中available会对ESSD、SSD、高效云盘依次尝试创建，直到创建成功。
        -   zoneid：期望创建云盘的可用区。

            如果是多可用区的情况，zoneid可同时配置多个，示例如下：

            ```
            zoneid: cn-hangzhou-a,cn-hangzhou-b,cn-hangzhou-c
            ```

        -   encrypted：可选参数。创建的云盘是否加密，默认情况是false，创建的云盘不加密。
    -   **回收策略**：云盘的回收策略，默认为Delete，支持Retain。如果数据安全性要求高，推荐使用Retain方式以免误删。
    -   **绑定模式**：默认为Immediate，可选值为Immediate、WaitForFirstConsumer。
    -   **挂载选项**：挂载volume时，可选择多种挂载选项。
6.  参数配置完成后，单击**创建**。


## 创建PVC

1.  登录[容器服务管理控制台](https://cs.console.aliyun.com)。

2.  在控制台左侧导航栏中，单击**集群**。

3.  在集群列表页面中，单击目标集群名称或者目标集群右侧**操作**列下的**详情**。

4.  在集群管理页左侧导航栏中，选择**存储** \> **存储声明**。

5.  在**存储声明**页签，单击右上角的**创建**。在弹出的创建存储声明对话框中设置参数。

    -   **存储声明类型**：包含**云盘**、**NAS**、**OSS**三种类型。本示例选择**云盘**。
    -   **名称**：创建的数据卷的名称。数据卷名在集群内必须唯一。
    -   **分配模式**：包含**使用存储类动态创建**、**已有存储卷**、**创建存储卷**三种模式。本示例选择**使用存储类动态创建**。
    -   **已有存储类**：单击**选择存储类**，在目标存储类右侧操作列单击**选择**。
    -   **总量**：所创建存储卷的容量。

        **说明：** 所创建的存储卷容量不能超过磁盘容量。

    -   **访问模式**：默认为ReadWriteOnce。
6.  单击**创建**。

    创建成功后可以在列表中看到test-cloud，并且已绑定相应的存储卷。

    ![创建存储声明1](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6585659951/p99109.png)


## 使用数据卷

1.  登录[容器服务管理控制台](https://cs.console.aliyun.com)。

2.  在控制台左侧导航栏中，单击**集群**。

3.  在集群列表页面中，单击目标集群名称或者目标集群右侧**操作**列下的**详情**。

4.  在集群管理页左侧导航栏中，选择**工作负载** \> **无状态**。

5.  在**无状态**页面单击**使用镜像创建**。

6.  配置创建无状态应用信息。

    本例主要为您介绍数据卷的配置。其他界面参数请参见[创建无状态工作负载Deployment](/cn.zh-CN/Kubernetes集群用户指南/应用/工作负载/创建无状态工作负载Deployment.md)。

    数据卷支持配置本地存储和云存储。

    -   **本地存储**：支持主机目录（HostPath ）、配置项（ConfigMap）、保密字典（Secret）和临时目录，将对应的挂载源挂载到容器路径中。更多信息请参见 [volumes](https://kubernetes.io/docs/concepts/storage/volumes/?spm=0.0.0.0.8VJbrE)。
    -   **云存储**：支持云盘/NAS/OSS三种云存储类型。
    本例中配置了一个云盘类型的数据卷，将该云盘挂载到容器中/tmp路径下，在该路径下生成的容器数据会存储到云盘中。

    ![数据卷](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6785659951/p59980.jpg)

7.  所有的信息都配置完成后，单击**创建**。

    创建成功后，您就可以正常使用数据卷。


您也可以通过命令行的方式使用动态云盘卷，请参见[通过命令行使用动态云盘卷](/cn.zh-CN/Kubernetes集群用户指南/存储-Flexvolume/云盘存储卷/通过命令行使用动态云盘卷.md)。

