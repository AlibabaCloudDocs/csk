---
keyword: CVE-2021-30465
---

# Vulnerability CVE-2021-30465

The Open Containers Initiative community has reported a vulnerability that is related to runC. An attacker can use a symlink and race condition flaws to mount the host file system to a container by creating a malicious pod. This results in a container escape. This topic describes the vulnerability, affected versions, impacts, and fixes of the vulnerability.

## Description

In a Kubernetes cluster, an attacker can specify a mount target as a symlink in a volume that is mounted to the root directory of the host. For example, /var/lib/kubelet/pods/$MY\_POD\_UID/volumes/kubernetes.io~empty-dir specifies the symlink of the emptyDir volume. This way, the attacker can obtain a mount target from the host. The mount source is a directory that is controlled by the attacker. Therefore, the attacker can use a symlink to link the subdirectories from the mount source to the root directory of the host. Then, the attacker can exploit a Time Of Check To Time Of Use \(TOCTTOU\) flaw to mount a specified directory of the malicious container to the root directory of the host.

The CVE-2021-30465 vulnerability is rated high and the Common Vulnerability Scoring System \(CVSS\) score of the vulnerability is 7.6. For more information, see [Official announcements](https://github.com/opencontainers/runc/security/advisories/GHSA-c3xm-pvg7-gh7r).

## Impacts

When multiple containers are started in a pod, an attacker can use a race condition and create a malicious pod which contains a mount target with a symlink. Under certain circumstances, the attacker can escape and access the host file system except for the container `rootfs` file system.

## Affected versions

runC 1.0.0-rc94 and earlier versions are affected by this vulnerability.

The vulnerability is fixed in runC 1.0.0-rc95. For more information, see [runC v1.0.0-rc95](https://github.com/opencontainers/runc/releases/tag/v1.0.0-rc95).

## Fixes

-   Manually upgrade containerd to the latest version.
-   Use pod security policies or Open Policy Agent \(OPA\) to force pods to launch without root privileges and limit the capabilities of pods, for example, Drop: `CAP_DAC_READ_SEARCH`.
-   Use pod security policies or OPA to specify a list of host paths that are allowed.
-   Use AppArmor, SELinux, or Seccomp to limit the read and write permissions on the host file system and the permissions to call `open_by_handle_at`.

